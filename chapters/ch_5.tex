\chapter{表格制作}

表格是一种针对信息和数据的有效呈现方式，一般采用行和列组合的结构。在撰写科技论文时，往往
需要使用表格对信息或数据进行归纳、整理以及比较分析。本章主要介绍如何在LaTeX中制作和编辑
表格，内容包括：
\begin{itemize}
    \item 第1节是对制作表格的环境和命令进行基本介绍；
    \item 第2、3节介绍如何合并单元格、插入斜线与表注；
    \item 第4节介绍如何调整表格样式，包括表格尺寸、单元格自动对齐与换行、小数点对齐、行高、列宽、线宽、以及字体大小；
    \item 第5~8节介绍如何创建特殊表格，分别为彩色表格、三线表格、跨页表格、旋转表格（或纵向表格）；
    \item 第9节介绍如何从csv文件中导入表格。
\end{itemize}

通过本章的学习，读者会对LaTeX制作和编辑表格有较为全面的认识，能够制作出科技论文中的各类表格。

\section{基本介绍}
表格是展现数据的一种常用方式。LaTeX提供了多种表格环境可用于制作各类表格，例如\emph{tabular}、
\emph{tabular*}、\emph{tabularx}、\emph{tabulary}、\emph{table}和\emph{longtable}
等。其中比较常用的方法是将tabular环境嵌入到table环境中，可以创建包含表格内容、表格标题、引
用标签等属性的完整表格。

\subsection{tabular环境：创建表格内容}
通过创建tabular环境可以定义表格内容、对齐方式、外观样式等，使用方式与前面章节中介绍的使
用array环境制作数表（即矩阵）的方式类似。例如：
$$\left[
        \begin{array}{c|c|c}
            a        & b & c \\
            \hline d & e & f \\
            \hline g & h & i \\
        \end{array}
        \right]$$

上面矩阵的代码为：
\begin{lstlisting}[language=TeX]
$$\left[
    \begin{array}{c|c|c}
        a        & b & c \\
        \hline d & e & f \\
        \hline g & h & i \\
    \end{array}
\right]$$
\end{lstlisting}

不妨将上述代码中的array环境改写为tabular环境，并去掉\texttt{\textbackslash{}left[}和
\texttt{\textbackslash{}right]}命令，得到如下所示的代码语句：
\begin{lstlisting}[language=TeX]
    \begin{tabular}{c|c|c}
        a & b & c \\
        \hline
        d & e & f \\
        \hline
        g & h & i \\
    \end{tabular}        
\end{lstlisting}

编译上述代码，可以得到类似的结果：
\begin{center}
    \begin{tabular}{c|c|c}
        a & b & c \\
        \hline
        d & e & f \\
        \hline
        g & h & i \\
    \end{tabular}
\end{center}

不同之处在于，array环境制作的数表是属于数学公式，而使用tabular环境制作得到的表格则属于
文本内容，但两者的用法及命令格式极其相似。在tabular环境下：
\begin{itemize}
    \item 在\texttt{\textbackslash{}begin\{tabular\}}命令后的\{\}内设置表格的列类型参数，包括：
          \begin{itemize}
              \item 设置每列的单元格对齐方式。对齐方式选项包括\emph{l}、\emph{c}和\emph{r}，即
                    left、center和right的首字母，分别对应左对齐、居中对齐和右对齐，每个字母对应一列；
              \item 创建表格列分隔线。表格列分隔线以|符号表示，|符号的个数表示
                    列分隔线中线的个数，如|表示使用单线分隔列，||表示使用双线分隔列，以此
                    类推。分割线符号可以设置在列对齐方式选项的左侧或右侧，分别表示创建列的左分隔线和右分隔线。
          \end{itemize}
    \item 使用\texttt{\textbackslash{}\textbackslash{}}符号表示一行内容的结束；
    \item 使用\&符号划分行内的单元格；
    \item 使用\texttt{\textbackslash{}hline}命令创建行分隔线。
\end{itemize}

下面给出一个示例让读者对tabular环境的使用方式能有更深刻的印象。

\emph{【例】}使用tabular环境制作一个简单的表格，\{l|cccr\}命令调整列对齐方式：
\begin{lstlisting}[language=TeX]
    \begin{tabular}{l|cccr} % 调整对齐方式
        \hline
        & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
        \hline
        $y=x$ & 1 & 2 & 3 & 4 \\
        $y=x^{2}$ & 1 & 4 & 9 & 16 \\
        $y=x^{3}$ & 1 & 8 & 27 & 64 \\
        \hline
    \end{tabular}
\end{lstlisting}

\begin{table}
    \centering
    \begin{tabular}{l|cccr} % 调整对齐方式
        \hline
                  & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
        \hline
        $y=x$     & 1     & 2     & 3     & 4     \\
        $y=x^{2}$ & 1     & 4     & 9     & 16    \\
        $y=x^{3}$ & 1     & 8     & 27    & 64    \\
        \hline
    \end{tabular}
    \caption{编译后的表格}
    \label{tb1}
\end{table}
编译上述代码，得到表格如表\ref{tb1}所示。

\subsection{table环境：自动编号与浮动表格}
使用table环境嵌套tabular环境，能够为创建的表格进行自动递增编号。此外，可以使用\texttt{\textbackslash{}caption\{\}}
命令设置表格标题、使用\texttt{\textbackslash{}label\{\}}命令为表格建立索引标签、使用
\texttt{\textbackslash{}centering}命令将表格置于文档中间，如下所示：
\begin{lstlisting}[language=TeX]
    \begin{table}
    \centering
        \caption{Title of a table.}
        \label{Label of the table}
        \begin{tabular}
        % 表格内容
        \end{tabular}
    \end{table}
\end{lstlisting}

下例创建表格嵌入到table环境中，创建了一个位置居中、并且具有标题、索引、自动编号的表格。

\emph{【例】}使用table和tabular环境制作一个简单的表格：
\begin{lstlisting}[language=TeX]
    \begin{table}
    \centering
        \begin{tabular}{l|cccr}
            \hline
            & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
            \hline
            $y=x$ & 1 & 2 & 3 & 4 \\
            $y=x^{2}$ & 1 & 4 & 9 & 16 \\
            $y=x^{3}$ & 1 & 8 & 27 & 64 \\
            \hline
        \end{tabular}
    \end{table}
\end{lstlisting}

\begin{table}
    \centering
    \begin{tabular}{l|cccr}
        \hline
                  & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
        \hline
        $y=x$     & 1     & 2     & 3     & 4     \\
        $y=x^{2}$ & 1     & 4     & 9     & 16    \\
        $y=x^{3}$ & 1     & 8     & 27    & 64    \\
        \hline
    \end{tabular}
    \caption{编译后的表格}
    \label{tb2}
\end{table}

编译上述代码，得到表格如\ref{tb2}。

事实上，在table环境中创建的表格属于浮动元素:
\begin{quote}
    浮动元素（floating）是指不能跨页分割的元素，比如图片和表格。一般而言，浮动元素的显示
    位置未必是代码的位置，比如，当页面空间不足时，LaTeX会根据内置的算法尝试将浮动元素放置
    到后面的页面中，避免出现内容跨页分割或者页面大量留白的情况，从而创建更协调也更专业的文档。
\end{quote}

通过在\texttt{\textbackslash{}begin\{table\}[]}的[]中设置位置控制参数，可以为浮动表格
指定期望放置位置，各参数值及其含义如下：
\begin{itemize}
    \item \texttt{h}：英文单词here的首写字母，表示代码当前位置；
    \item \texttt{t}：英文单词top的首写字母，表示页面顶部位置；
    \item \texttt{b}：英文单词bottom的首写字母，表示页面底部位置；
    \item \texttt{p}：英文单词page的首写字母，表示后面的页面；
    \item \texttt{!}：\texttt{!}参数一般与其它位置参数配合使用，表示当空间足够时，强制
          将表格放在指定位置。如\texttt{!h}表示将表格强制放到当前页面，但当页面空间不足时，也
          可能被放置到后续页面中；
    \item \texttt{H}：表示将表格强制放在代码当前位置，具有比\texttt{!h}更严格的效果，
          使用时需要先在导言区使用\texttt{\textbackslash{}usepackage\{float\}}声明语句调用
          float宏包。
\end{itemize}

根据需要，浮动元素的位置控制参数一般可以设置为\texttt{h}、\texttt{b}、\texttt{t}、
\texttt{p}、\texttt{!}和\texttt{H}的任意无需组合。该参数的缺省值为\texttt{tbp}，此时
LaTeX会尝试将表格放在页面的顶端或者底端，否则会将表格放在下一页。

\emph{【例】}在table环境中将表格的位置控制参数设置为htbp：
\begin{lstlisting}[language=TeX]
    \begin{table}[htbp] % 设置位置参数
        \centering
        % \caption{The values of some basic functions.}
        \begin{tabular}{l|cccr}
            \hline
            & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
            \hline
            $y=x$ & 1 & 2 & 3 & 4 \\
            $y=x^{2}$ & 1 & 4 & 9 & 16 \\
            $y=x^{3}$ & 1 & 8 & 27 & 64 \\
            \hline
        \end{tabular}
        % \label{table1}
    \end{table}
\end{lstlisting}

\begin{table}[htbp] % 设置位置参数
    \centering
    \begin{tabular}{l|cccr}
        \hline
                  & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
        \hline
        $y=x$     & 1     & 2     & 3     & 4     \\
        $y=x^{2}$ & 1     & 4     & 9     & 16    \\
        $y=x^{3}$ & 1     & 8     & 27    & 64    \\
        \hline
    \end{tabular}
    \caption{编译后的表格}
    \label{tb3}
\end{table}

编译上述代码，得到表格如表\ref{tb3}所示。

\section{合并单元格}
如果需要合并单元格，首先应在导言区声明\texttt{\textbackslash{}usepackage\{multirow\}}
导入\emph{multirow}宏包，并使用\texttt{\textbackslash{}multicolumn}命令合并同行不同
列的单元格、使用\\texttt{\textbackslash{}multirow}命令合并同列不同行的单元格。

\subsection{合并不同列的单元格}
合并不同列的单元格时，应在tabular环境中使用\texttt{\textbackslash{}multicolumn\{合并列数\}
    \{合并后的列类型参数\}\{单元格内容\}}语句定义合并单元格。此时，合并后的单元格的列类型将
由\texttt{\textbackslash{}multicolumn}给出，而非\texttt{\textbackslash{}begin\{tabular\}}
中预设的列类型参数。

\emph{【例】}合并不同列的单元格：
\begin{lstlisting}[language=TeX]
    \usepackage{multirow}
    \begin{document}

    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1 & Column2 & Column3 & Column4 \\
        \hline
        \multicolumn{2}{|c|}{A1 and A2} & A3 & A4 \\
        \hline
        B1 & B2 & B3 & B4 \\
        \hline
        C1 & C2 & C3 & C4 \\
        \hline
    \end{tabular}

    \end{document}
\end{lstlisting}

\begin{table}[h]
    \centering
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1                         & Column2 & Column3 & Column4 \\
        \hline
        \multicolumn{2}{|c|}{A1 and A2} & A3      & A4                \\
        \hline
        B1                              & B2      & B3      & B4      \\
        \hline
        C1                              & C2      & C3      & C4      \\
        \hline
    \end{tabular}
    \caption{编译后的表格}
    \label{tb4}
\end{table}

编译上述代码，得到表格如\ref{tb4}所示。

\subsection{合并不同行的单元格}

合并不同行的单元格时使用的语句为\texttt{\textbackslash{}multirow\{合并行数\}\{合并后的宽度\}\{单元格内容\}}。
如果把\{合并后的宽度\}参数设置为\{*\}，那么LaTeX会根据文本内容自动设置单元格宽度。在绘
制行分隔线时，使用\texttt{\textbackslash{}hline}命令会创建一条横跨表格左右两端的横线，
显然不适用于合并单元格后的行。此时应用\texttt{\textbackslash{}cline\{起始列号-终止列号\}}命令，
通过指定行分隔线的起始列和终止列，从而定制跨越了部分列的行分隔线。

\emph{【例】}合并不同列的单元格，并定制行分隔线的起始点：
\begin{lstlisting}[language=TeX]
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1 & Column2 & Column3 & Column4 \\
        \hline
        \multirow{2}{*}{A1 and B1} & A2 & A3 & A4 \\
        \cline{2-4} % 创建一条从第2列到第4列的行分隔线
        & B2 & B3 & B4 \\
        \hline
        C1 & C2 & C3 & C4 \\
        \hline
    \end{tabular}
\end{lstlisting}

\begin{table}[h]
    \centering
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1                    & Column2 & Column3 & Column4 \\
        \hline
        \multirow{2}{*}{A1 and B1} & A2      & A3      & A4      \\
        \cline{2-4} % 创建一条从第2列到第4列的行分隔线
                                   & B2      & B3      & B4      \\
        \hline
        C1                         & C2      & C3      & C4      \\
        \hline
    \end{tabular}
    \caption{编译后的表格}
    \label{tb5}
\end{table}

编译上述代码，得到表格如\ref{tb5}所示。

从上例可以看出，合并多行的单元格时，除了第一个单元格处使用\texttt{\textbackslash{}multirow}
命令定义单元格，其余被合并的单元格处均留空。

\subsection{合并不同行不同列的单元格}
通过嵌套使用\texttt{\textbackslash{}multicolumn}和\texttt{\textbackslash{}multirow}
命令可以实现对不同行不同列单元格的合并操作，具体语句为\texttt{\textbackslash{}multicolumn\{合并列数\}\{合并后的列类型参数\}\{\textbackslash{}multirow\{合并行数\}\{合并后的宽度\}\{单元格内容\}\}}。

\emph{【例】}合并不同行不同列的单元格：
\begin{lstlisting}[language=TeX]
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1 & Column2 & Column3 & Column4 \\
        \hline
        \multicolumn{2}{|c|}{\multirow{2}{*}{A1, A2, B1 and B2}} & A3 & A4 \\ % 合并不同行不同列的单元格
        \cline{3-4} % 创建一条从第3列到第4列的行分隔线
        \multicolumn{2}{|c|}{} & B3 & B4 \\
        \hline
        C1 & C2 & C3 & C4 \\
        \hline
    \end{tabular}
\end{lstlisting}

编译上述代码，得到表格如表\ref{tb6}所示。
\begin{table}[h]
    \centering
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1                                                  & Column2 & Column3 & Column4 \\
        \hline
        \multicolumn{2}{|c|}{\multirow{2}{*}{A1, A2, B1 and B2}} & A3      & A4                \\ % 合并不同行不同列的单元格
        \cline{3-4} % 创建一条从第3列到第4列的行分隔线
        \multicolumn{2}{|c|}{}                                   & B3      & B4                \\
        \hline
        C1                                                       & C2      & C3      & C4      \\
        \hline
    \end{tabular}
    \caption{编译后的表格}
    \label{tb6}
\end{table}

\section{插入斜线与表注}

\subsection{插入斜线}

在制作斜线表头或填充空白单元格时，经常需要用到斜线。在LaTeX中，我们可以通过调用\emph{diagbox}
宏包及其提供的\texttt{\textbackslash{}diagbox[参数]\{单元格内容1\}...\{单元格内容n\}}
命令将一个单元格划分为n个部分（即插入(n-1)条斜线），并且可以在[]中设置不同参数，从而对斜
线宽度、高度、方向等属性进行调整，主要包括：
\begin{itemize}
    \item width：设置斜线宽度；
    \item height：设置斜线高度；
    \item font：设置单元格字体大小和字体类型；
    \item linewidth：设置线宽；
    \item linecolor：设置线的颜色（需结合xcolor或其他宏包使用）；
    \item dir：设置斜线方向，包括NW（默认）、NE、SW和SE，分别表示西北方向、东北方向、
          西南方向、东南方向。当仅插入一个斜线时，dir=NW与dir=SE、dir=NE与dir=SW效果相同，
          分别表示插入反斜线和斜线；
\end{itemize}

当插入两个斜线时，如\texttt{\textbackslash{}diagbox[设置dir参数]\{A\}\{B\}\{C\}}，
使用NW、NE、SW和SE的效果分别如表\ref{tb7}所示：

\begin{table}[h]
    \centering
    \begin{tabular}{|c|}
        \hline
        \diagbox[dir=NW]{A}{B}{C} \\
        \hline
    \end{tabular}
    \begin{tabular}{|c|}
        \hline
        \diagbox[dir=NE]{A}{B}{C} \\
        \hline
    \end{tabular}
    \begin{tabular}{|c|}
        \hline
        \diagbox[dir=SW]{A}{B}{C} \\
        \hline
    \end{tabular}
    \begin{tabular}{|c|}
        \hline
        \diagbox[dir=SE]{A}{B}{C} \\
        \hline
    \end{tabular}
    \caption{将方向参数设置为NW、NE、SW和SE的效果示意图}
    \label{tb7}
\end{table}

\emph{【例】}制作双斜线表头：
\begin{lstlisting}[language=TeX]
    \begin{table}[htbp] % 设置位置参数
        \centering
        \caption{The values of some basic functions.}
        \begin{tabular}{l|cccr}
            \hline
            \diagbox[width=5em]{$y$}{value}{$x$} & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
            \hline
            $y=x$ & 1 & 2 & 3 & 4 \\
            $y=x^{2}$ & 1 & 4 & 9 & 16 \\
            $y=x^{3}$ & 1 & 8 & 27 & 64 \\
            \hline
        \end{tabular}
        \label{table1}
    \end{table}
\end{lstlisting}

编译上述代码，得到表格如表\ref{tb8}所示。

\begin{table}[htbp] % 设置位置参数
    \centering
    \begin{tabular}{l|cccr}
        \hline
        \diagbox[width=5em]{$y$}{value}{$x$} & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
        \hline
        $y=x$                                & 1     & 2     & 3     & 4     \\
        $y=x^{2}$                            & 1     & 4     & 9     & 16    \\
        $y=x^{3}$                            & 1     & 8     & 27    & 64    \\
        \hline
    \end{tabular}
    \caption{斜线表示例}
    \label{tb8}
\end{table}

\subsection{插入表注}

为了对表格内容进行解释说明，通常会在表格底部添加注释，即表注。在LaTeX中添加表注的方式有
多种，其中比较常用的一种是使用\emph{threeparttable}宏包及其相关命令，可以在表格底部生
成与表格内容同宽的表注，并且当注释内容过长时可以实现自动换行，相比于其它方式更协调一致。

具体是在tabular环境外嵌套一层\emph{threeparttable}环境，并在tabular环境之后将表注内容添加在
\emph{tablenotes}环境中，由此得到的表注将会显示在表格底部。如果需要将表格内容与表注建立
关联关系，可以在表格内容的相应位置使用\texttt{\textbackslash{}tnote\{索引标记\}}添加
表注的索引标记，并且在tablenotes环境中使用item[索引标记]命令创建这项表注。

\emph{【例】}添加表注：
\begin{lstlisting}[language=TeX]
    \usepackage{booktabs}
    \usepackage{threeparttable}
    \begin{document}

    \begin{table}
        \centering
        \begin{threeparttable}
            \begin{tabular}{l|cccr}
                \toprule
                & $x=1$ & $x=2$ & $x=3$ & $x=4$ \\
                \midrule
                $y=x$ & 1\tnote{*} & 2 & 3 & 4 \\
                $y=x^{2}$ & 1 & 4 & 9 & 16 \\
                $y=x^{3}$ & 1 & 8 & 27 & 64 \\
                \bottomrule
            \end{tabular}
            \begin{tablenotes}
                \footnotesize
                \item[1] This is a remark example.
                \item[2] This is another remark example and with a very long content, but the contents will be wrapped.
                \item[*] This is 1.
            \end{tablenotes}
        \end{threeparttable}
    \end{table}

    \end{document}
\end{lstlisting}

编译上述代码，得到表格如表\ref{tb9}所示。

\begin{table}[htbp]
    \centering
    \begin{threeparttable}
        \begin{tabular}{l|cccr}
            \toprule
                      & $x=1$      & $x=2$ & $x=3$ & $x=4$ \\
            \midrule
            $y=x$     & 1\tnote{*} & 2     & 3     & 4     \\
            $y=x^{2}$ & 1          & 4     & 9     & 16    \\
            $y=x^{3}$ & 1          & 8     & 27    & 64    \\
            \bottomrule
        \end{tabular}
        \begin{tablenotes}
            \footnotesize
            \item[1] This is a remark example.
            \item[2] This is another remark example and with a very long content, but the contents will be wrapped.
            \item[*] This is 1.
        \end{tablenotes}
    \end{threeparttable}
    \caption{表注示例}
    \label{tb9}
\end{table}

\section{调整表格样式}

通过调用一些宏包及命令可以定制表格样式，从而创建更符合要求的表格。对表格样式的调整可以分
为以下7个方面：表格尺寸、单元格自动对齐与换行、小数点对齐、行高、列宽、线宽、以及表格字
体大小。

\subsection{表格尺寸}
如果想要修改表格尺寸，首先使用\texttt{\textbackslash{}usepackage\{graphicx\}}语句调用
\textmd{graphicx}宏包，并使用\texttt{\textbackslash{}resizebox\{宽度\}\{高度\}\{内容\}}命令，
该命令以tabular环境构建的表格作为内容。为了避免产生不协调的尺寸，在设置参数时只需要设置
\{宽度\}和\{高度\}中的其中一个即可，另一个以!作为参数，表示根据宽高比进行自动调整。

\emph{【例】}调整表格尺寸：
\begin{lstlisting}[language=TeX]
    \usepackage{graphicx}

    \begin{table}[h]
    \centering
        \resizebox{0.8\textwidth}{!}{
        \begin{tabular}{|l|l|l|l|}
            \hline
            Column1 & Column2 & Column3 & Column4 \\
            \hline
            A1 & A2 & A3 & A4 \\
            \hline
            B1 & B2 & B3 & B4 \\
            \hline
            C1 & C2 & C3 & C4 \\
            \hline
        \end{tabular}}
    \end{table}
\end{lstlisting}

编译后得到表\ref{tb10}。

\begin{table}[h]
    \centering
    \resizebox{0.8\textwidth}{!}{
        \begin{tabular}{|l|l|l|l|}
            \hline
            Column1 & Column2 & Column3 & Column4 \\
            \hline
            A1      & A2      & A3      & A4      \\
            \hline
            B1      & B2      & B3      & B4      \\
            \hline
            C1      & C2      & C3      & C4      \\
            \hline
        \end{tabular}}
    \caption{调整表格尺寸=0.8}
    \label{tb10}
\end{table}

\subsection{单元格自动对齐与换行}

使用列类型参数\emph{l}、\emph{c}或\emph{r}可以对每列的单元格设置左对齐、横向居中对齐和
右对齐，但由此创建的单元格不仅无法设置顶部对齐、纵向居中对齐、以及底部对齐方式，而且单元
格内容不论长短都被拉长为一行，显得不够灵活。下面介绍几种方式用于实现单元格自动对齐与换行。

\subsubsection{使用array宏包实现单元格自动对齐与换行}

首先在导言区使用\texttt{\textbackslash{}usepackage\{array\}}语句声明调用\emph{array}宏包，
该宏包提供了以下6个列类型参数分别对应不同的对齐方式：
\begin{itemize}
    \item p\{列宽\}：单元格内容将根据设置的列宽自动换行，并且对齐方式为顶部对齐；
    \item m\{列宽\}：单元格内容将根据设置的列宽自动换行，并且对齐方式为纵向居中对齐；
    \item b\{列宽\}：单元格内容将根据设置的列宽自动换行，并且对齐方式为底部对齐；
    \item \texttt{>\{\textbackslash{}raggedright\textbackslash{}arraybackslash\}}：将一列的单元格内容设置为左对齐；
    \item \texttt{>\{\textbackslash{}centering\textbackslash{}arraybackslash\}}：将一列的单元格内容设置为横向居中对齐；
    \item \texttt{>\{\textbackslash{}raggedleft\textbackslash{}arraybackslash\}}：将一列的单元格内容设置为右对齐。
\end{itemize}

默认情况下，如果单独使用\emph{p}、\emph{m}或\emph{b}参数，默认为左对齐。我们可以对上述
参数进行组合使用，从而获得不同的对齐效果。需要注意的是，此时应使用\texttt{\textbackslash{}tabularnewline}
取代\texttt{\textbackslash{}\textbackslash{}}符号作为表格一行的结束。

\emph{【例】}调用array宏包及其提供的列类型参数实现单元格自动对齐与分行：
\begin{lstlisting}[language=TeX]
    \usepackage{array}

    \begin{table}[h]
    \centering
        \begin{tabular}{|>{\raggedright\arraybackslash}m{2.3cm}|>{\centering\arraybackslash}m{2.3cm}|>{\centering}m{2.3cm}|>{\raggedleft\arraybackslash}m{2.3cm}|}
            \hline
            Column1 & Column2 Column2 & Column3 Column3 Column3 & Column4 Column4 Column4 Column4 \tabularnewline
            \hline
            Value1 & Value2 Value2 & Value3 Value3 Value3 & Value4 Value4 Value4 Value4 \tabularnewline
            \hline
            Value1 & Value2 Value2 & Value3 Value3 Value3 & Value4 Value4 Value4 Value4 \tabularnewline
            \hline
        \end{tabular}
    \end{table}
\end{lstlisting}

编译后得到表\ref{tb11}。

\begin{table}[h]
    \centering
    \begin{tabular}{|>{\raggedright\arraybackslash}m{2.3cm}|>{\centering\arraybackslash}m{2.3cm}|>{\centering}m{2.3cm}|>{\raggedleft\arraybackslash}m{2.3cm}|}
        \hline
        Column1 & Column2 Column2 & Column3 Column3 Column3 & Column4 Column4 Column4 Column4 \tabularnewline
        \hline
        Value1  & Value2 Value2   & Value3 Value3 Value3    & Value4 Value4 Value4 Value4 \tabularnewline
        \hline
        Value1  & Value2 Value2   & Value3 Value3 Value3    & Value4 Value4 Value4 Value4 \tabularnewline
        \hline
    \end{tabular}
    \caption{单元格自动对齐与分行}
    \label{tb11}
\end{table}

通过调用array宏包的方式虽然可以实现自动换行，但常常需要经过反复试验才能获得想要的宽度，
更方便的方式是使用\emph{tabularx}宏包或\emph{tabulary}宏包及其相关命令自动计算列宽。
对于涉及文本的表格，更推荐使用tabulary宏包。下面分别介绍通过这两个宏包及其命令如何实现
自动换行。

\subsubsection{使用tabularx宏包实现自动换行}

首先在导言区声明调用\emph{tabularx}宏包，然后使用\emph{tabularx}环境取代tabular环境创
建表格内容，tabularx环境的使用方式与tabular类似，不同之处主要在于：\texttt{\textbackslash{}begin\{tabularx\}
    \{表格宽度\}\{列类型\}}中应设置表格宽度；在tabularx环境中，对于需要自动换行的列，其列类
型应设置为大写的\emph{X}。X参数可以与\texttt{>\{\textbackslash{}raggedright\textbackslash{}arraybackslash\}}、
\texttt{>\{\textbackslash{}centering\textbackslash{}arraybackslash\}}或
\texttt{>\{\textbackslash{}raggedleft\textbackslash{}arraybackslash\}}进行组合使用，
从而修改单元格的对齐方式。

\emph{【例】}调用tabularx宏包并设置列类型参数X从而实现单元格内容自动换行：
\begin{lstlisting}[language=TeX]
    \usepackage{tabularx} % 调用tabularx宏包

    \begin{table}[h]
    \centering
        \caption{Title of a table.}
        \label{first label}
        \begin{tabularx}{\linewidth}{|X|X|X|>{\centering\arraybackslash}X|} % 将需要自动换行的列的列类型参数设为X
            \hline
            Column1 & Column2 & Column3 & Column4 \\
            \hline
            This is Value1. This is Value1. & This is Value2. This is Value2. & This is Value3. This is Value3. & This is Value4. This is Value4. \\
            \hline
            This is Value1. This is Value1. This is Value1. & This is Value2. This is Value2. This is Value2. & This is Value3. This is Value3. This is Value3. & This is Value4. This is Value4. This is Value4. \\
            \hline
        \end{tabularx}
    \end{table}
\end{lstlisting}

编译上述代码，得到表\ref{tb12}。

\begin{table}[h]
    \centering
    \begin{tabularx}{\linewidth}{|X|X|X|>{\centering\arraybackslash}X|} % 将需要自动换行的列的列类型参数设为X
        \hline
        Column1                                         & Column2                                         & Column3                                         & Column4                                         \\
        \hline
        This is Value1. This is Value1.                 & This is Value2. This is Value2.                 & This is Value3. This is Value3.                 & This is Value4. This is Value4.                 \\
        \hline
        This is Value1. This is Value1. This is Value1. & This is Value2. This is Value2. This is Value2. & This is Value3. This is Value3. This is Value3. & This is Value4. This is Value4. This is Value4. \\
        \hline
    \end{tabularx}
    \caption{使用宏包tabularx实现单元格内容自动换行}
    \label{tb12}
\end{table}

\subsubsection{使用tabulary宏包实现自动换行}

类似地，调用\emph{tabulary}宏包并使用\texttt{\textbackslash{}begin\{tabulary\}\{表格宽度\}
    \{列类型\}}环境创建表格。对于需要自动换行的列，只需将列类型改为大写字母即可，即，大写\emph{L}
表示左对齐并自动换行、大写\emph{C}表示居中对齐并自动换行、大写\emph{R}表示右对齐并自动换行。

\emph{【例】}调用tabulary宏包并设置大写列类型参数（L、C和R）从而实现单元格内容自动换行：
\begin{lstlisting}[language=TeX]
    \usepackage{tabulary} % 调用tabulary宏包

    \begin{table}[h]
    \centering
        \caption{Title of a table.}
        \label{first label}
        \begin{tabulary}{\linewidth}{|L|C|C|R|} % 将需要自动换行的列的列类型参数改为大写
            \hline
            Column1 & Column2 & Column3 & Column4 \\
            \hline
            This is Value1. This is Value1. & This is Value2. This is Value2. & This is Value3. This is Value3. & This is Value4. This is Value4. \\
            \hline
            This is Value1. This is Value1. This is Value1. & This is Value2. This is Value2. This is Value2. & This is Value3. This is Value3. This is Value3. & This is Value4. This is Value4. This is Value4. \\
            \hline
        \end{tabulary}
    \end{table}
\end{lstlisting}

编译上述代码，得到表\ref{tb13}。

\begin{table}[h]
    \centering
    \begin{tabulary}{\linewidth}{|L|C|C|R|} % 将需要自动换行的列的列类型参数改为大写
        \hline
        Column1 & Column2 & Column3 & Column4 \\
        \hline
        This is Value1. This is Value1. & This is Value2. This is Value2. & This is Value3. This is Value3. & This is Value4. This is Value4. \\
        \hline
        This is Value1. This is Value1. This is Value1. & This is Value2. This is Value2. This is Value2. & This is Value3. This is Value3. This is Value3. & This is Value4. This is Value4. This is Value4. \\
        \hline
    \end{tabulary}
    \caption{使用tabulary宏包让单元格自动换行}
    \label{tb13}
\end{table}

\subsubsection{使用parbox命令实现人工换行}

我们也可以通过使用\texttt{\textbackslash{}parbox}命令对表格内容进行强制换行。

\emph{【例】}用parbox命令来实现单元格中文本强制换行：
\begin{lstlisting}[language=TeX]
    \begin{center}    
        \begin{tabular}{|c|c|c|c|}
            \hline
            a & b & c & d \\ 
            \hline
            a & b & c & \parbox[t]{5cm}{In probability theory and statistics, the continuous uniform distribution\\ or rectangular distribution is a family of symmetric probability distributions.} \\ 
            \hline
        \end{tabular} 
    \end{center}
\end{lstlisting}

编译上述代码，得到表\ref{tb14}。

\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        a & b & c & d                                                                                         \\
        \hline
        a & b & c & \parbox[t]{5cm}{In probability theory and statistics, the continuous uniform distribution \\ or rectangular distribution is a family of symmetric probability distributions.} \\
        \hline
    \end{tabular}
    \caption{使用parbox强制换行}
    \label{tb14}
\end{table}

\subsection{小数点对齐}

为了更好地描述数据，在表格中常常将数据在小数点处进行对齐，在LaTeX中我们可以通过使用\emph{dcolumn}包
实现这一目的。这个包提供了一个名为\emph{D}的列类型，可以方便实现基于小数点的数字对齐以及
基于其它符号的对齐，使用方式为D\{输入符号\}\{输出符号\}\{符号后的数字位数\}。对于基于小
数点的数字对齐，输入符号一般为“.”；有时需要根据特定符号进行数字对齐，比如千分位逗号，这时
输入符号即为“,”。例如，\texttt{D\{.\}\{\textbackslash{}cdot\}\{2\}}表示将某列的数据
根据“.”符号对齐，输出时将该符号显示为点乘符号，并且显示2个小数位数。

列类型D可以像其它列类型一样在表格环境的开始命令处直接进行设置，但会导致语句过长，所以一
般使用array宏包的\texttt{\textbackslash{}newcolumntype}命令定义一个新的列类型，并为
这个列类型赋予一个比较短的名称以方便调用。定义新的列类型的语句为\texttt{\textbackslash{}newcolumntype
\{新列类型名称\}[新列类型的参数个数]\{定义新列类型\}}，例如：\texttt{\textbackslash{}newcolumntype\{d\}[1]\{D\{.\}\{\textbackslash{}cdot\}\{\#1\}\}}表示创建一个名为d的新列类型，该列类型的内容为\texttt{D\{.\}\{\textbackslash{}cdot\}\{符号后的数字位数\}}，其中数字位数是传给d的参数。

\emph{【例】}调用dcolumn宏包和列类型D来实现表格数据的小数点对齐：
\begin{lstlisting}[language=TeX]
    \usepackage{dcolumn}
    \newcolumntype{d}[1]{D{.}{\cdot}{#1}}
    \begin{document}
        \begin{tabular}{|l|c|r|d{3}|}
            \hline
            Left & Center & Right & \mathrm{Decimal}\\
            \hline
            1.1 & 1.1 & 1.1 & 1.1\\
            \hline
            33.3 & 33.3 & 33.3 & 33.3\\
            \hline
            3.333 & 3.333 & 3.333 & 3.333\\
            \hline
        \end{tabular}
    \end{document}
\end{lstlisting}

编译上述代码，得到表\ref{tb15}。

\newcolumntype{d}[1]{D{.}{\cdot}{#1}}
\begin{table}[h]
    \centering
    \begin{tabular}{|l|c|r|d{3}|}
        \hline
        Left  & Center & Right & \mathrm{Decimal} \\
        \hline
        1.1   & 1.1    & 1.1   & 1.1              \\
        \hline
        33.3  & 33.3   & 33.3  & 33.3             \\
        \hline
        3.333 & 3.333  & 3.333 & 3.333            \\
        \hline
    \end{tabular}
    \caption{dcolumn宏包实现小数点对齐}
    \label{tb15}
\end{table}

\subsection{行高}

如果需要调整表格整体行高，可以在导言区使用\texttt{\textbackslash{}renewcommand\{\textbackslash{}arraystretch\}\{行高倍数\}}
命令，从而根据设置的行高倍数在默认值的基础上对行高进行扩大或缩小。

\emph{【例】}将表格整体行高设为两倍行距：
\begin{lstlisting}[language=TeX]
    \documentclass[12pt]{article}
    \renewcommand{\arraystretch}{2}
    \begin{document}
    % 文章内容
    \end{document}
\end{lstlisting}

另一种调整行高的方式是通过在每行的结束标志\texttt{\textbackslash{}\textbackslash{}}
后加上行高增减量选项，即\texttt{\textbackslash{}\textbackslash{}[行高增减量]}，从而
在默认值的基础上对各行行高进行增减。

\emph{【例】}为表格各行设置不同的行高：
\begin{lstlisting}[language=TeX]
    \begin{tabular}{|c|c|c|c|}
        \hline
        Column1 & Column2 & Column3 & Column4\\[0cm]
        \hline
        A1 & A2 & A3 & A4\\[0.2cm]
        \hline
        B1 & B2 & B3 & B4\\[0.4cm]
        \hline
        C1 & C2 & C3 & C4\\[0.6cm]
        \hline
    \end{tabular}
\end{lstlisting}

编译上述代码，得到表\ref{tb16}。

\begin{table}[h]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        Column1 & Column2 & Column3 & Column4 \\[0cm]
        \hline
        A1      & A2      & A3      & A4      \\[0.2cm]
        \hline
        B1      & B2      & B3      & B4      \\[0.4cm]
        \hline
        C1      & C2      & C3      & C4      \\[0.6cm]
        \hline
    \end{tabular}
    \caption{为表格各行设置不同的行高}
    \label{tb16}
\end{table}

\subsection{列宽}

在上面，我们介绍了使用array宏包提供的列类型参数可以在设置单元格对齐方式的同时对列宽进行
调整。此外，也可以在导言区使用\texttt{\textbackslash{}setlength\{textbackslash{}tabcolsep\}\{文本和列分隔线的间距\}}
命令修改表格列宽，默认情况下，单元格内容与列分隔线的间距为6pt。

\emph{【例】}将表格单元格文本和列分隔线的间距设为12pt：
\begin{lstlisting}[language=TeX]
    \setlength{\tabcolsep}{12pt}
    \begin{document}
    % 文章内容
    \end{document}
\end{lstlisting}

\subsection{线宽}

通过在导言区使用\texttt{\textbackslash{}setlength\{\textbackslash{}arrayrulewidth\}\{线宽\}}命令，可以修改表格线宽，默认为0.4pt。然而当线宽设置过大时，可能导致表格线交叉处不连续的情况。对此，在导言区调用xcolor宏包、并
设置table选项可以解决。

\emph{【例】}设置表格线宽：
\begin{lstlisting}[language=TeX]
    \usepackage[table]{xcolor} % 调用设置了table选项的xcolor宏包
    \setlength{\arrayrulewidth}{2pt} % 修改表格线宽
    \begin{document}
    % 文章内容
    \end{document}
\end{lstlisting}

\subsection{表格字体大小}

在文本编辑中我们知道，调整字体大小的方式既有全局方式也有局部方式，其中，全局方式是通过在
文档类型中指定字体大小，而局部方式则是通过一系列设置字体大小的命令，例如\texttt{\textbackslash{large}}、
\texttt{\textbackslash{Large}}、\texttt{\textbackslash{huge}}、\texttt{\textbackslash{fontsize}}等，
在全局字体大小的基础上作进一步的调整。类似地，在使用LaTeX创建表格时，我们也可以对表格字
体大小做全局或局部调整。

\emph{【例】}使用Large调整表格局部字体大小：
\begin{lstlisting}[language=TeX]
    \begin{table}[htp]
        \Large % 调整表格局部字体大小
        \centering
        \begin{tabular}{l|cccr}
            % 表格内容
        \end{tabular}
    \end{table}
\end{lstlisting}

\emph{【例】}使用fontsize调整表格局部字体大小：
\begin{lstlisting}[language=TeX]
    \begin{table}[htp]
        \fontsize{18pt}{24pt}\selectfont % 将字体大小设为18pt、行距设为24pt
        \centering
        \begin{tabular}{l|cccr}
            % 表格内容
        \end{tabular}
    \end{table}
\end{lstlisting}

\subsection{文字环绕表格}

如果想要实现文字环绕表格效果，可以使用\emph{wrapfig}宏包，并使用其提供的\emph{wraptable}环境
嵌套tabular环境创建表格，从而达到文字环绕表格的效果。

\emph{【例】}使用wraptable环境嵌套tabular环境创建表格，实现文字环绕表格；并使用
\texttt{\textbackslash{}begin\{wraptable\}\{r\}\{8cm\}}将表格置于文字右侧，同时将表
格和文字的距离设为8cm：

\begin{lstlisting}[language=TeX]
    \usepackage{wrapfig}
    \begin{document}
    % 段落
    \begin{wraptable}{r}{8cm}
        \centering
        \begin{tabular}{lcccc}
            % 表格内容
        \end{tabular}
    \end{wraptable}
    % 段落
    \end{document}
\end{lstlisting}

\section{创建色彩表格}
通过对表格的单元格、行或列填充颜色，可以创建不同的彩色表格。为此，首先应在导言区使用
\texttt{\textbackslash{}usepackage[table]\{xcolor\}}声明语句，通过调用xcolor宏包提
供的相关命令可以实现颜色填充。

填充单元格时，使用\texttt{\textbackslash{}cellcolor\{单元格填充颜色\}}单元格内容命令
定义单元格内容即可。

\emph{【例】}定义具有颜色填充效果的单元格：
\begin{lstlisting}[language=TeX]
    \documentclass[12pt]{article}
    \usepackage[table]{xcolor} % 调用设置了table选项的xcolor宏包
    \begin{document}
    \begin{table}
        \centering
        \begin{tabular}{|l|l|l|l|}
            \hline
            Column1              & Column2 & Column3 & Column4 \\
            \hline
            \cellcolor{red!80}A1 & A2      & A3      & A4      \\ % 使用\cellcolor命令设置单元格填充颜色
            \hline
            \cellcolor{red!50}B1 & B2      & B3      & B4      \\
            \hline
            \cellcolor{red!20}C1 & C2      & C3      & C4      \\
            \hline
        \end{tabular}
        \caption{表格示例1}
        \label{table1}
    \end{table}
    \end{document}
\end{lstlisting}

\begin{table}
    \centering
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1              & Column2 & Column3 & Column4 \\
        \hline
        \cellcolor{red!80}A1 & A2      & A3      & A4      \\ % 使用\cellcolor命令设置单元格填充颜色
        \hline
        \cellcolor{red!50}B1 & B2      & B3      & B4      \\
        \hline
        \cellcolor{red!20}C1 & C2      & C3      & C4      \\
        \hline
    \end{tabular}
    \caption{表格示例1}
    \label{table1}
\end{table}
编译上述代码，得到表\ref{table1} ：

为了达到更好的可视化效果，有时候需要为表格的奇数行和偶数行交替设置不同的填充颜色，那么只
需要在tabular环境前使用\texttt{\textbackslash{}rowcolors\{开始填充的行编号\}\{第一个行填充颜色\}\{第二个行填充颜色\}}
命令即可：
\begin{lstlisting}[language=TeX]
    \begin{table}
        \centering
        \rowcolors{2}{red!50}{red!20} % 设置表格交替填充行颜色
        \begin{tabular}{|l|l|l|l|}
            \hline
            Column1 & Column2 & Column3 & Column4 \\
            \hline
            A1      & A2      & A3      & A4      \\
            \hline
            B1      & B2      & B3      & B4      \\
            \hline
            C1      & C2      & C3      & C4      \\
            \hline
        \end{tabular}
        \caption{表格示例2}
        \label{table2}
    \end{table}
\end{lstlisting}

\begin{table}
    \centering
    \rowcolors{2}{red!50}{red!20} % 设置表格交替填充行颜色
    \begin{tabular}{|l|l|l|l|}
        \hline
        Column1 & Column2 & Column3 & Column4 \\
        \hline
        A1      & A2      & A3      & A4      \\
        \hline
        B1      & B2      & B3      & B4      \\
        \hline
        C1      & C2      & C3      & C4      \\
        \hline
    \end{tabular}
    \caption{表格示例2}
    \label{table2}
\end{table}
编译上述代码，得到表\ref{table2} ：

\section{创建三线表格}

\emph{booktabs}宏包提供了更美观的行分隔线创建命令，常用于创建三线表格。其中，\texttt{\textbackslash{}toprule}
命令常用于创建表格顶线、\texttt{\textbackslash{}bottomrule}命令常用于创建表格底线、
\texttt{\textbackslash{}midrule}命令常用于创建表格标题栏和表格内容的分隔线、以及
\texttt{\textbackslash{}cmidrule\{起始列号-终止列号\}}命令用于创建标题栏内部的分隔线
并设置分隔线的跨越范围。

\emph{【例】}调用booktabs宏包及其相关命令创建三线表：
\begin{lstlisting}[language=TeX]
    \usepackage{booktabs}
    \usepackage{multirow}
    \begin{document}

    \begin{tabular}{cccc}
        \toprule
        \multicolumn{2}{c}{\textbf{Type1}} & \\
        \cmidrule{1-2}
        Column1 & Column2 & Column3 & Column4\\
        \midrule
        A1 & A2 & A3 & A4\\
        B1 & B2 & B3 & B4\\
        C1 & C2 & C3 & C4\\
        \bottomrule
    \end{tabular}

    \end{document}
\end{lstlisting}

编译上述代码，得到表\ref{tb561}。

\begin{table}[h]
    \centering
    \begin{tabular}{cccc}
        \toprule
        \multicolumn{2}{c}{\textbf{Type1}} &                             \\
        \cmidrule{1-2}
        Column1                            & Column2 & Column3 & Column4 \\
        \midrule
        A1                                 & A2      & A3      & A4      \\
        B1                                 & B2      & B3      & B4      \\
        C1                                 & C2      & C3      & C4      \\
        \bottomrule
    \end{tabular}
    \caption{三线表示例}
    \label{tb561}
\end{table}

\section{创建跨页表格}

当表格太长时，使用tabular环境创建的表格会被裁剪掉页面放不下的部分。如果想让表格在行数太
多时实现自动分页，可以通过调用\emph{longtable}宏包并使用\emph{longtable}环境创建表格。

在longtable环境中创建表格的方式与使用table和tabular嵌套环境类似，我们也能使用\texttt{\textbackslash{}caption}、
\texttt{\textbackslash{}label}命令分别创建表格标题和索引标签。不同之处主要在于，longtable
环境中可以设置跨页表格在每一页的重复表头和表尾，按照使用顺序，包括以下四个命令：
\begin{itemize}
    \item \texttt{\textbackslash{}endfirsthead}：\texttt{\textbackslash{}begin\{longtable\}}
          和\texttt{\textbackslash{}endfirsthead}之间的内容只会出现在表格第一页的表头部分；
    \item \texttt{\textbackslash{}endhead}：\texttt{\textbackslash{}endfirsthead}和
          \texttt{\textbackslash{}endhead}之间的内容将会出现在表格除第一页之外的表头部分；
    \item \texttt{\textbackslash{}endfoot}：\texttt{\textbackslash{}endhead}和
          \texttt{\textbackslash{}endfoot}之间的内容将会出现在除表格最后一页之外的表尾部分；
    \item \texttt{\textbackslash{}endlastfoot}：\texttt{\textbackslash{}endfoot}
          和\texttt{\textbackslash{}endlastfoot}之间的内容只会出现在表格最后一页的表尾部分。
\end{itemize}

以上四个命令需要放置在longtable环境的开始处。

\emph{【例】}调用longtable宏包及环境创建跨页表格：
\begin{lstlisting}[language=TeX]
    \usepackage{longtable}
    \usepackage{multirow}
    \begin{document}

    \begin{longtable}[c]{cccc}
        % 创建表格第一页的表头部分
        \caption{Title of a table}\\
        \hline
        Column1 & Column2 & Column3 & Column4\\
        \hline
        \endfirsthead
        % 创建表格除第一页之外的表头部分
        \caption{Title of a table - Continued}\\
        \hline
        Column1 & Column2 & Column3 & Column4\\
        \hline
        \endhead
        % 创建表格除最后一页之外的表尾部分
        \hline
        \endfoot
        % 创建表格最后一页的表尾部分
        \multicolumn{4}{c}{\textbf{End of table.}}\\
        \hline
        \endlastfoot
        % 表格内容
        A1 & A2 & A3 & A4\\
        B1 & B2 & B3 & B4\\
        C1 & C2 & C3 & C4\\
        A1 & A2 & A3 & A4\\
        B1 & B2 & B3 & B4\\
        C1 & C2 & C3 & C4\\
        ... % 省略中间部分
        A1 & A2 & A3 & A4\\
        B1 & B2 & B3 & B4\\
        C1 & C2 & C3 & C4\\
        \hline
    \end{longtable}
\end{lstlisting}

\section{旋转表格}

当表格列数太多时，横向表格的展现效果较差，这时需要将表格旋转90度，以纵向表格的形式展现。
在LaTeX中可以通过调用\emph{rotating}宏包，并使用\emph{sidewaystable}环境取代table环境、嵌套tabular
环境创建纵向表格（表格逆时针旋转90度）。

\emph{【例】}调用rotating宏包及sidewaystable环境创建纵向表格：
\begin{lstlisting}[language=TeX]
    \usepackage{rotating}
    \usepackage{booktabs}
    \begin{document}

    \begin{sidewaystable}[h]
    \centering
        \caption{Title of a table.}
        \label{first label}
        \begin{tabular}{cccc}
            \toprule
            Column1 & Column2 & Column3 & Column4\\
            \midrule
            A1 & A2 & A3 & A4\\
            B1 & B2 & B3 & B4\\
            C1 & C2 & C3 & C4\\
            \bottomrule
        \end{tabular}
    \end{sidewaystable}
\end{lstlisting}

\section{导入表格}

一个表格有时候可能涉及大量数据，这时在LaTeX中手动输入数据并创建表格显然不够灵活，对此，
可以通过导入csv文件数据的方式创建表格。LaTeX提供了\emph{csvsimple}、\emph{pgfplotstable}、
\emph{csvtools}等宏包可以帮助用户实现基于csv文件快速导入表格，其中，使用csvsimple宏包
及其命令是一种比较常用的方式，我们下面将对其展开介绍。

\subsection{快速创建表格}

首先在导言区使用\texttt{\textbackslash{}usepackage\{csvsimple\}}语句声明对\emph{csvsimple}
宏包的调用，然后在文档主体内容中使用\texttt{\textbackslash{}csvautotabular\{csv文件名或文件路径\}}
命令即可导入csv文件从而快速创建表格。作为导入数据的csv文件，既可以预先放在指定目录下，
也可以在\emph{filecontents}环境中创建，示例语句如下：
\begin{lstlisting}[language=TeX]
    \begin{filecontents}{dataimport.csv}
        COLUMNa,COLUMNb,COLUMNc,COLUMNd
        1.1,2.2,3.3,4.4
        11.1,22.2,33.3,44.4
        1.111,2.222,3.333,4.444
    \end{filecontents}
\end{lstlisting}

通过上述语句，创建了一个名为“dataimport.csv”的csv文件。

\emph{【例】}使用filecontents环境创建一个名为“dataimport.csv”的csv文件，并调用csvsimple
宏包及\texttt{\textbackslash{}csvautotabular}命令快速根据csv文件创建表格：
\begin{lstlisting}[language=TeX]
    \begin{filecontents}{dataimport.csv}
    COLUMNa,COLUMNb,COLUMNc,COLUMNd
    1.1,2.2,3.3,4.4
    11.1,22.2,33.3,44.4
    1.111,2.222,3.333,4.444
    \end{filecontents}
    
    \documentclass{article}
    \usepackage{csvsimple}
    \begin{document}
    \begin{table}
    \centering
        \caption{A table imported from csv file}
        \label{labeloftable1}
        \csvautotabular{dataimport.csv}
    \end{table}
    \end{document}
\end{lstlisting}

\subsection{创建三线表}

也可以结合\emph{booktabs}宏包，使用\texttt{\textbackslash{}csvautobooktabular}命令
自动读取csv文件并创建更专业的三线表格。

\emph{【例】}使用filecontents环境创建一个名为“dataimport.csv”的csv文件，并调用csvsimple
和booktabs宏包，使用\texttt{\textbackslash{}csvautobooktabular}命令快速根据csv文件创建三线表格：
\begin{lstlisting}[language=TeX]
    \begin{filecontents}{dataimport.csv}
    COLUMNa,COLUMNb,COLUMNc,COLUMNd
    1.1,2.2,3.3,4.4
    11.1,22.2,33.3,44.4
    1.111,2.222,3.333,4.444
    \end{filecontents}
    
    \documentclass{article}
    \usepackage{csvsimple}
    \usepackage{booktabs}
    \begin{document}
    \begin{table}
    \centering
        \caption{A table imported from csv file}
        \label{labeloftable1}
        \csvautobooktabular{dataimport.csv}
    \end{table}
    \end{document}
\end{lstlisting}

\subsection{设置表格属性}

如果想要调整导入的表格样式、表头、指定导入列等属性，可以使用\texttt{\textbackslash{}csvreader[属性设置]
\{csv文件名或文件路径\}\{定义数据列名\}\{需要导入的数据列名\}}命令读取csv文件创建表格，
并通过设置属性选项、指定需要导入的数据列名从而调整表格属性。在属性设置选项中，主要包括以
下属性：
\begin{itemize}
    \item tabular：定义列类型。列类型个数应与需要导入的列数一致；
    \item table head：定义表头，包括标题行的顶线、列名、以及底线。由此可以对各列名进行重定义或省略；
    \item late after line：定义行分隔线。如，单行分隔线设置表示为\texttt{late after line=\textbackslash{}\textbackslash{}\textbackslash{}hline}。
\end{itemize}

\emph{【例】}使用csvreader命令读取csv文件创建表格，并将表格列名从“COLUMNa,COLUMNb,
COLUMNc,COLUMNd”重命名为“column1,column2,column3,column4”，并分别设置数据列名
“ca,cb,cc,cd”用于指定导入哪些列：
\begin{lstlisting}[language=TeX]
    \begin{filecontents*}{dataimport.csv}
    COLUMNa,COLUMNb,COLUMNc,COLUMNd
    1.1,2.2,3.3,4.4
    11.1,22.2,33.3,44.4
    1.111,2.222,3.333,4.444
    \end{filecontents*}
    
    \documentclass{article}
    \usepackage{csvsimple}
    \begin{document}
    \begin{table}
    \centering
        \caption{A table imported from csv file}
        \label{labeloftable1}
        \csvreader[tabular=|l|l|l|l|,
        table head=\hline column1 & column2 & column3 & column4\\\hline,
        late after line=\\\hline] % 表格属性设置
        {dataimport.csv} % csv文件名
        {COLUMNa =\ca, COLUMNb =\cb, COLUMNc =\cc, COLUMNd =\cd} % 定义数据列名
        {\ca & \cb & \cc & \cd} % 需要导入的数据列名
    \end{table}
    \end{document}
\end{lstlisting}

如果需要对导入的表格增加行标签列，那么在设置需要导入的数据列名时增加\texttt{\textbackslash{}thecsvrow}
命令即可。

\emph{【例】}使用csvreader命令读取csv文件创建表格，指定导入的数据列为前两列，并使用
\texttt{\textbackslash{}thecsvrow}命令增加行标签列：
\begin{lstlisting}[language=TeX]
    \begin{filecontents}{dataimport.csv}
    COLUMNa,COLUMNb,COLUMNc,COLUMNd
    1.1,2.2,3.3,4.4
    11.1,22.2,33.3,44.4
    1.111,2.222,3.333,4.444
    \end{filecontents}
    
    \documentclass{article}
    \usepackage{csvsimple}
    \begin{document}
    \begin{table}
    \centering
        \caption{A table imported from csv file}
        \label{labeloftable1}
        \csvreader[tabular=|l|l|l|,
        table head=\hline & column1 & column2\\\hline,
        late after line=\\\hline] % 表格属性设置
        {dataimport.csv} % csv文件名
        {COLUMNa =\ca, COLUMNb =\cb, COLUMNc =\cc, COLUMNd =\cd} % 定义数据列名
        {\thecsvrow & \ca & \cb} % 需要导入的数据列名
    \end{table}
    \end{document}
\end{lstlisting}